import{r as i,j as a}from"./vendor-mRmXoTzJ.js";import{B as A,e as C,f as F,C as f,a as j,b as ee,c as ae,g as se,A as te}from"./AppFooter-D1BxJuTO.js";import{I as re}from"./input-CDCc1mAV.js";import{A as ie,b as ne,d as le}from"./index-BYCepXWl.js";import{A as de,B}from"./AppHeader-CnLp3pGj.js";import{f as oe,a as ce,g as me,d as D}from"./lolApi-eHDD5ks5.js";import{u as P,b as ue,g as xe,a as $,f as H}from"./playerStore-DAbDxbBn.js";import{q as pe,r as ge,j as he,T as be,m as fe,s as je}from"./icons-LK5f2ZN2.js";import{m as Q}from"./motion-DeyU0M5x.js";import{a as ke,u as Ne}from"./router-b8HoQcXb.js";import"./radix-Ba4cyD9q.js";const u="BR1";function Ee(){const U=ke(),k=Ne(),s=U.state,d=P(e=>e.player),N=P(e=>e.setPlayer),[o,w]=i.useState((s&&"player"in s?s.player.puuid:s?.puuid)??d?.puuid??null),[m,v]=i.useState((s&&"player"in s?s.player.name:s?.gameName)??d?.gameName??""),[p,z]=i.useState((s&&"player"in s?s.player.tag:s?.tagLine)??d?.tagLine??""),[c,y]=i.useState((s&&"player"in s?s.region??s.player.queueRanks?.[0]?.region:s?.region)??d?.region??u),[h,S]=i.useState([]),[V,L]=i.useState(null),[n,R]=i.useState(!1),[r,T]=i.useState(s?.matches??[]),[G,E]=i.useState(!1),[b,K]=i.useState(""),I=e=>[...e].sort((t,l)=>(l.gameEndTimestamp??0)-(t.gameEndTimestamp??0));i.useEffect(()=>{if(s&&"player"in s){const e=s.player;w(e.puuid),v(e.name),z(e.tag),y(s.region??e.queueRanks?.[0]?.region??u),T(I(s.matches??[])),S((e.queueRanks??[]).map(t=>({queueType:t.queueType,tier:t.tier,rank:t.rank}))),L(e.profileIconId??null),R(!0),N({puuid:e.puuid,gameName:e.name,tagLine:e.tag,region:s.region??e.queueRanks?.[0]?.region??u})}else if(s?.puuid)w(s.puuid),v(s.gameName),z(s.tagLine),y(s.region??u),T(I(s.matches??[])),N({puuid:s.puuid,gameName:s.gameName,tagLine:s.tagLine,region:s.region??u});else{const e=P.getState().getPlayer();e?.puuid&&(w(e.puuid),v(e.gameName),z(e.tagLine),y(e.region??u))}},[s,N]),i.useEffect(()=>{if(s&&"player"in s||!o||n)return;const t=(m||d?.gameName)??"",l=(p||d?.tagLine)??"";!t||!l||oe(t,l,c||u).then(g=>{S((g.queueRanks??[]).map(x=>({queueType:x.queueType,tier:x.tier,rank:x.rank}))),L(g.profileIconId??null)}).catch(()=>{S([]),L(null)}).finally(()=>R(!0))},[s,o,m,p,c,n,d?.gameName,d?.tagLine]),i.useEffect(()=>{!o||!c||!(r.length===0)||(E(!0),ce({puuid:o,region:c}).then(t=>T(I(t))).finally(()=>E(!1)))},[o,c,r.length]);const O=(()=>{const e=b.trim()?r.filter(t=>t.champion.toLowerCase().includes(b.toLowerCase())||t.matchId.toLowerCase().includes(b.toLowerCase())):[...r];return e.sort((t,l)=>(l.gameEndTimestamp??0)-(t.gameEndTimestamp??0)),e})(),_=e=>e>=90?"bg-purple-500/20 text-purple-300 dark:text-purple-400 border-purple-500/30":e>=75?"bg-blue-500/20 text-blue-300 dark:text-blue-400 border-blue-500/30":e>=55?"bg-emerald-500/20 text-emerald-300 dark:text-emerald-400 border-emerald-500/30":e>=35?"bg-amber-500/20 text-amber-300 dark:text-amber-400 border-amber-500/30":"bg-red-500/20 text-red-300 dark:text-red-400 border-red-500/30",W=e=>e?"bg-emerald-500/20 text-emerald-300 dark:text-emerald-400 border-emerald-500/30":"bg-red-500/20 text-red-300 dark:text-red-400 border-red-500/30",M=r?.length>0?r.reduce((e,t)=>e+(typeof t.score=="number"?t.score:50),0)/r.length:0,J=r?.filter(e=>e.result).length??0,q=r?.length>0?Math.round(J/r.length*100):0,X=r?.length>0?(r.reduce((e,t)=>{const[l,g,x]=t.kda.split("/").map(Z=>parseInt(Z.trim(),10)||0);return e+(g>0?(l+x)/g:l+x)},0)/r.length).toFixed(1):"0",Y=r?.length>0?(r.reduce((e,t)=>e+t.csPerMin,0)/r.length).toFixed(1):"0";return o?a.jsxs("div",{className:"min-h-screen w-full bg-zinc-100 text-zinc-900 transition-colors duration-500 dark:bg-zinc-950 dark:text-zinc-100",children:[a.jsxs("div",{className:"pointer-events-none fixed inset-0 overflow-hidden",children:[a.jsx("div",{className:"absolute -top-40 left-1/2 -translate-x-1/2 h-[500px] w-[500px] rounded-full bg-purple-600/20 blur-[120px]"}),a.jsx("div",{className:"absolute bottom-0 right-0 h-[400px] w-[400px] rounded-full bg-blue-600/20 blur-[120px]"})]}),a.jsx(de,{backTo:"/",badgeLabel:"Dashboard",maxWidth:"max-w-7xl"}),a.jsxs("main",{className:"relative z-10 mx-auto max-w-7xl px-6 py-8 space-y-8",children:[a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[n?a.jsxs(ie,{className:"w-12 h-12 border border-white/10",children:[a.jsx(ne,{src:`https://ddragon-webp.lolmath.net/latest/img/profileicon/${V??1}.webp`,alt:`${m} avatar`}),a.jsx(le,{className:"bg-purple-500/20 text-purple-300",children:m.slice(0,2).toUpperCase()})]}):a.jsx(C,{className:"w-12 h-12 rounded-full shrink-0"}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:[m,"#",p]}),a.jsxs("div",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["Score médio ",Math.round(M),"/100 • ",q,"% taxa de vitória"]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[a.jsxs("span",{className:"text-xs text-zinc-500",children:["Região: ",c]}),n&&h.length===0&&a.jsx("span",{className:"text-xs text-amber-500 dark:text-amber-400",children:"Nenhuma fila ranqueada"})]})]})]}),a.jsxs("div",{className:"relative w-full md:w-64",children:[a.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),a.jsx(re,{placeholder:"Buscar partida por campeão ou ID",value:b,onChange:e=>K(e.target.value),className:"pl-10 bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-500 focus-visible:ring-purple-500 dark:bg-white/5 dark:border-white/10 dark:text-zinc-100 dark:placeholder:text-zinc-500"})]})]}),!n&&a.jsxs("div",{className:"w-full md:w-auto flex flex-wrap gap-3",children:[a.jsx(F,{className:"min-w-[180px] flex-1"}),a.jsx(F,{className:"min-w-[180px] flex-1"})]}),n&&h.length>0&&a.jsx("div",{className:"w-full md:w-auto flex flex-wrap gap-3",children:h.map(e=>a.jsx(f,{className:"flex-1 w-full max-w-full md:w-auto min-w-[180px] md:max-w-[240px] border-zinc-200/80 bg-white/80 backdrop-blur-xl dark:border-white/10 dark:bg-white/5",children:a.jsxs(j,{className:"p-4",children:[a.jsx("div",{className:"text-xs font-medium text-zinc-500 mb-1",children:ue(e.queueType)}),a.jsxs("div",{className:"font-semibold text-purple-600 dark:text-purple-300",children:[e.tier," ",e.rank,e.leaguePoints!=null&&a.jsxs("span",{className:"text-sm font-normal ml-1 text-zinc-600 dark:text-zinc-400",children:[e.leaguePoints," LP"]})]}),(e.wins!=null||e.losses!=null)&&a.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5",children:[e.wins??0,"V ",e.losses??0,"D",(e.wins??0)+(e.losses??0)>0&&a.jsxs("span",{className:"ml-1",children:["(",(100*(e.wins??0)/((e.wins??0)+(e.losses??0))).toFixed(0),"%)"]})]})]})},e.queueType))}),n&&h.length===0&&a.jsxs("div",{className:"rounded-xl border p-4 bg-amber-50 border-amber-200 text-amber-800 dark:bg-amber-500/10 dark:border-amber-500/30 dark:text-amber-200",role:"alert",children:[a.jsx("p",{className:"font-medium",children:"Você não está ranqueado em nenhuma fila."}),a.jsx("p",{className:"text-sm mt-1 opacity-90",children:"Os benchmarks por elo estão disponíveis apenas para contas ranqueadas (Solo ou Flex). Suas métricas continuam visíveis; a comparação com o ideal do elo não será exibida."})]}),a.jsx("div",{className:"grid md:grid-cols-4 gap-4",children:n?[{label:"Score médio",value:`${Math.round(M)}/100`,icon:ge},{label:"KDA médio",value:X,icon:he},{label:"CS/min",value:Y,icon:be},{label:"Taxa de vitória",value:`${q}%`,icon:fe}].map((e,t)=>a.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},children:a.jsx(f,{className:"border-zinc-200/80 bg-white/80 backdrop-blur-xl dark:border-white/10 dark:bg-white/5",children:a.jsxs(j,{className:"p-4 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:e.label}),a.jsx("div",{className:"text-xl font-semibold text-zinc-900 dark:text-zinc-100",children:e.value})]}),a.jsx(e.icon,{className:"w-5 h-5 text-purple-400"})]})})},t)):Array.from({length:4}).map((e,t)=>a.jsx(f,{className:"border-zinc-200/80 bg-white/80 backdrop-blur-xl dark:border-white/10 dark:bg-white/5",children:a.jsx(j,{className:"p-4 flex justify-between items-center",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx(C,{className:"h-4 w-20"}),a.jsx(C,{className:"h-6 w-12"})]})})},t))}),a.jsxs(f,{className:"border-zinc-200/80 bg-white/80 backdrop-blur-xl dark:border-white/10 dark:bg-white/5",children:[a.jsx(ee,{children:a.jsx(ae,{className:"text-zinc-900 dark:text-zinc-100",children:"Histórico recente"})}),a.jsx(j,{className:"space-y-3",children:G||!n?a.jsx(se,{count:5}):O.map(e=>(me(e),a.jsxs(Q.div,{whileHover:{y:-2},className:"flex flex-wrap md:flex-nowrap items-center justify-between gap-3 p-4 rounded-xl border border-zinc-200/80 bg-zinc-50/50 hover:bg-zinc-100/80 dark:border-white/10 dark:bg-white/5 dark:hover:bg-white/10 transition cursor-pointer backdrop-blur-xl",onClick:()=>k(`/match/${e.matchId}`,{state:{puuid:o,gameName:m,tagLine:p,region:c,tier:e.tier??void 0,rank:e.rank??void 0}}),children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/14.1.1/img/champion/${e.champion}.png`,alt:"",className:"w-12 h-12 rounded-lg border border-white/10 object-cover bg-zinc-800",onError:t=>{t.target.src=""}}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-zinc-900 dark:text-zinc-100",children:e.champion}),a.jsxs("div",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:[e.kda," • ",e.csPerMin," CS/min"]}),a.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5",children:[xe(e.queueId),$(e.teamPosition)&&a.jsxs(a.Fragment,{children:[" • ",$(e.teamPosition)]}),H(e.gameEndTimestamp)&&a.jsxs(a.Fragment,{children:[" • ",H(e.gameEndTimestamp)]})]}),(e.tier??e.rank)&&D(e)&&a.jsxs("div",{className:"text-xs mt-1 text-purple-600 dark:text-purple-300",children:["Ideal do elo: ",D(e)]})]})]}),a.jsxs("div",{className:"flex w-full md:w-auto justify-end md:justify-start md:items-center gap-3",children:[a.jsx(B,{className:_(typeof e.score=="number"?e.score:50),children:typeof e.score=="number"?e.score:"—"}),a.jsx(B,{className:W(e.result),children:e.result?"Vitória":"Derrota"}),a.jsx(A,{size:"sm",variant:"ghost",className:"text-zinc-600 dark:text-zinc-400 hover:bg-white/10",onClick:t=>{t.stopPropagation(),k(`/match/${e.matchId}`,{state:{puuid:o,gameName:m,tagLine:p,region:c,tier:e.tier??void 0,rank:e.rank??void 0}})},children:a.jsx(je,{size:16})})]})]},e.matchId)))})]})]}),a.jsx(te,{})]}):a.jsx("div",{className:"min-h-screen w-full bg-zinc-100 text-zinc-900 dark:bg-zinc-950 dark:text-zinc-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-zinc-500",children:"Nenhum jogador carregado."}),a.jsx(A,{className:"mt-4",onClick:()=>k("/"),children:"Buscar Riot ID"})]})})}export{Ee as default};
